syntax = "proto3";

package yandex.cloud.priv.billing.integration.v1;

import "google/api/annotations.proto";
import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/priv/billing/integration/v1/instance.proto";

option go_package = "a.yandex-team.ru/contrib/ydb/public/api/client/yc_private/billing/integration/v1;billing_integration";
option java_package = "yandex.cloud.priv.billing.integration.v1";
option java_outer_classname = "PBIS";

service InstanceService {

  rpc Enable (EnableServiceInstanceRequest) returns (operation.Operation) {
    option (google.api.http) = {
      post: "/billingIntegration/v1/serviceInstance/{instance_id}:enable"
      body: "*"
    };
    option (yandex.cloud.api.operation) = {
      response: "google.protobuf.Empty"
    };
  }

  rpc Disable (DisableServiceInstanceRequest) returns (operation.Operation) {
    option (google.api.http) = {
      post: "/billingIntegration/v1/serviceInstance/{instance_id}:disable"
      body: "*"
    };
    option (yandex.cloud.api.operation) = {
      response: "google.protobuf.Empty"
    };
  }

  rpc Get (GetServiceInstanceRequest) returns (ServiceInstance) {
    option (google.api.http) = {
      get: "/billingIntegration/v1/serviceInstance/{instance_id}"
    };
  }

  rpc AuthorizeBinding (AuthorizeBindingRequest) returns (AuthorizeBindingResponse) {
    option (google.api.http) = {
      post: "/billingIntegration/v1/serviceInstance/{instance_id}:authorizeBinding"
      body: "*"
    };
  }
}


message EnableServiceInstanceRequest {
  string instance_id = 1;
}

message DisableServiceInstanceRequest {
  string instance_id = 1;
}

message GetServiceInstanceRequest {
  string instance_id = 1;
}

message AuthorizeBindingResponse {
  string instance_id = 1;
}

message AuthorizeBindingRequest {
  enum SubjectType {
    SUBJECT_TYPE_UNSPECIFIED = 0;
    YANDEX_PASSPORT_USER_ACCOUNT = 1;
    SERVICE_ACCOUNT = 2;
    USER_ACCOUNT = 3;
  }
  string instance_id = 1;
  string subject_id = 2;
  SubjectType subject_type = 3;
}
