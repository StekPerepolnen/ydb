syntax = "proto3";

package yandex.cloud.priv.billing.v1;

import "yandex/cloud/priv/access/access.proto";
import "yandex/cloud/priv/billing/v1/billing_account.proto";
import "yandex/cloud/priv/billing/v1/billable_object.proto";
import "yandex/cloud/priv/operation/operation.proto";
import "yandex/cloud/api/operation.proto";
import "yandex/cloud/priv/validation.proto";


option go_package = "a.yandex-team.ru/contrib/ydb/public/api/client/yc_private/billing/v1;billing";


service BillingAccountService {

    rpc Get(GetBillingAccountRequest) returns (BillingAccount);

    rpc List(ListBillingAccountsRequest) returns (ListBillingAccountsResponse);

    rpc ListBillableObjectBindings(ListBillableObjectBindingsRequest) returns (ListBillableObjectBindingsResponse);

    rpc BindBillableObject(BindBillableObjectRequest) returns (operation.Operation) {
        option (yandex.cloud.api.operation) = {
            metadata: "BindBillableObjectMetadata"
            response: "BillableObjectBinding"
        };
    }

    rpc ListAccessBindings(access.ListAccessBindingsRequest) returns (access.ListAccessBindingsResponse);

    rpc UpdateAccessBindings(access.UpdateAccessBindingsRequest) returns (operation.Operation) {
        // no operation in console response, retrieve or new handler?
        option (yandex.cloud.api.operation) = {
            metadata: "access.UpdateAccessBindingsMetadata"
            response: "google.protobuf.Empty"
        };
    }
}


message GetBillingAccountRequest {
    string id = 1 [(required) = true, (length) = "<=50"];
}


message ListBillingAccountsRequest {
    int64 page_size = 2 [(value) = "<=1000"]; // no pagination

    string page_token = 3 [(length) = "<=100"];
}

message ListBillingAccountsResponse {
    repeated BillingAccount billing_accounts = 1;

    string next_page_token = 2;
}

message ListBillableObjectBindingsRequest {
    string billing_account_id = 1 [(required) = true, (length) = "<=50"];

    int64 page_size = 2 [(value) = "<=1000"];

    string page_token = 3 [(length) = "<=100"];
}

message ListBillableObjectBindingsResponse {
    repeated BillableObjectBinding billable_object_bindings = 1;

    string next_page_token = 2;
}

message BindBillableObjectRequest {
    string billing_account_id = 1 [(required) = true, (length) = "<=50"];
    BillableObject billable_object = 2;
}

message BindBillableObjectMetadata {
    string billable_object_id = 1;
}
